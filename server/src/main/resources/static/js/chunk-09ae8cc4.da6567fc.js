(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-09ae8cc4"],{"0fea":function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"d",function(){return s}),n.d(t,"b",function(){return i}),n.d(t,"a",function(){return l});var a=n("b775"),r={user:"/user",role:"/role",service:"/service",permission:"/permission",permissionNoPager:"/permission/no-pager",orgTree:"/org/tree"};function o(e){return Object(a["b"])({url:r.role,method:"get",params:e})}function s(e){return Object(a["b"])({url:r.service,method:"get",params:e})}function i(e){return Object(a["b"])({url:r.permissionNoPager,method:"get",params:e})}function l(e){return Object(a["b"])({url:r.orgTree,method:"get",params:e})}},4002:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-card",{attrs:{bordered:!1}},[n("div",{staticClass:"table-page-search-wrapper"},[n("a-form",{attrs:{layout:"inline"}},[n("a-row",{attrs:{gutter:48}},[n("a-col",{attrs:{md:8,sm:24}},[n("a-form-item",{attrs:{label:"角色ID"}},[n("a-input",{attrs:{placeholder:"请输入"}})],1)],1),n("a-col",{attrs:{md:8,sm:24}},[n("a-form-item",{attrs:{label:"状态"}},[n("a-select",{attrs:{placeholder:"请选择","default-value":"0"}},[n("a-select-option",{attrs:{value:"0"}},[e._v("全部")]),n("a-select-option",{attrs:{value:"1"}},[e._v("正常")]),n("a-select-option",{attrs:{value:"2"}},[e._v("禁用")])],1)],1)],1),n("a-col",{attrs:{md:8,sm:24}},[n("span",{staticClass:"table-page-search-submitButtons"},[n("a-button",{attrs:{type:"primary"}},[e._v("查询")]),n("a-button",{staticStyle:{"margin-left":"8px"}},[e._v("重置")])],1)])],1)],1)],1),n("s-table",{ref:"table",attrs:{size:"default",columns:e.columns,data:e.loadData},scopedSlots:e._u([{key:"expandedRowRender",fn:function(t){return n("div",{staticStyle:{margin:"0"}},[n("a-row",{style:{marginBottom:"12px"},attrs:{gutter:24}},e._l(t.permissions,function(t,a){return n("a-col",{key:a,style:{marginBottom:"12px"},attrs:{span:12}},[n("a-col",{attrs:{span:4}},[n("span",[e._v(e._s(t.permissionName)+"：")])]),t.actionEntitySet.length>0?n("a-col",{attrs:{span:20}},e._l(t.actionEntitySet,function(t,a){return n("a-tag",{key:a,attrs:{color:"cyan"}},[e._v(e._s(t.describe))])}),1):n("a-col",{attrs:{span:20}},[e._v("-")])],1)}),1)],1)}},{key:"action",fn:function(t,a){return n("span",{},[n("a",{on:{click:function(t){e.$refs.modal.edit(a)}}},[e._v("编辑")]),n("a-divider",{attrs:{type:"vertical"}}),n("a-dropdown",[n("a",{staticClass:"ant-dropdown-link"},[e._v("\n          更多 "),n("a-icon",{attrs:{type:"down"}})],1),n("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[n("a-menu-item",[n("a",{attrs:{href:"javascript:;"}},[e._v("详情")])]),n("a-menu-item",[n("a",{attrs:{href:"javascript:;"}},[e._v("禁用")])]),n("a-menu-item",[n("a",{attrs:{href:"javascript:;"}},[e._v("删除")])])],1)],1)],1)}}])}),n("role-modal",{ref:"modal",on:{ok:e.handleOk}})],1)},r=[],o=n("e8c4"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",{attrs:{title:"操作",width:800,visible:e.visible,confirmLoading:e.confirmLoading},on:{ok:e.handleOk,cancel:e.handleCancel}},[n("a-spin",{attrs:{spinning:e.confirmLoading}},[n("a-form",{attrs:{form:e.form}},[n("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"唯一识别码",hasFeedback:""}},[n("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["id",{rules:[]}],expression:"[ 'id', {rules: []} ]"}],attrs:{placeholder:"唯一识别码",disabled:"disabled"}})],1),n("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"角色名称",hasFeedback:""}},[n("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"不起一个名字吗？"}]}],expression:"[ 'name', {rules: [{ required: true, message: '不起一个名字吗？' }] }]"}],attrs:{placeholder:"起一个名字"}})],1),n("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"状态",hasFeedback:""}},[n("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["status",{rules:[]}],expression:"[ 'status', {rules: []} ]"}]},[n("a-select-option",{attrs:{value:1}},[e._v("正常")]),n("a-select-option",{attrs:{value:2}},[e._v("禁用")])],1)],1),n("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"描述",hasFeedback:""}},[n("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["describe",{rules:[]}],expression:"[ 'describe', { rules: [] } ]"}],attrs:{rows:5,placeholder:"..."}})],1),n("a-divider"),n("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"拥有权限",hasFeedback:""}},e._l(e.permissions,function(t,a){return n("a-row",{key:a,attrs:{gutter:16}},[n("a-col",{attrs:{span:4}},[e._v("\n            "+e._s(t.name)+"：\n          ")]),n("a-col",{attrs:{span:20}},[t.actionsOptions.length>0?n("a-checkbox",{attrs:{indeterminate:t.indeterminate,checked:t.checkedAll},on:{change:function(n){e.onChangeCheckAll(n,t)}}},[e._v("\n              全选\n            ")]):e._e(),n("a-checkbox-group",{attrs:{options:t.actionsOptions},on:{change:function(n){e.onChangeCheck(t)}},model:{value:t.selected,callback:function(n){e.$set(t,"selected",n)},expression:"permission.selected"}})],1)],1)}),1)],1)],1)],1)},i=[],l=n("0fea"),c=n("bade"),u=n("88bc"),d=n.n(u),m={name:"RoleModal",data:function(){return{labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},visible:!1,confirmLoading:!1,mdl:{},form:this.$form.createForm(this),permissions:[]}},created:function(){this.loadPermissions()},methods:{add:function(){this.edit({id:0})},edit:function(e){var t=this;if(this.mdl=Object.assign({},e),this.visible=!0,this.mdl.permissions&&this.permissions){var n={};this.mdl.permissions.forEach(function(e){n[e.permissionId]=e.actionEntitySet.map(function(e){return e.action})}),this.permissions.forEach(function(e){e.selected=n[e.id]})}this.$nextTick(function(){t.form.setFieldsValue(d()(t.mdl,"id","name","status","describe"))}),console.log("this.mdl",this.mdl)},close:function(){this.$emit("close"),this.visible=!1},handleOk:function(){var e=this;this.form.validateFields(function(t,n){t||(console.log("form values",n),e.confirmLoading=!0,new Promise(function(e){setTimeout(function(){return e()},2e3)}).then(function(){e.$message.success("保存成功"),e.$emit("ok")}).catch(function(){}).finally(function(){e.confirmLoading=!1,e.close()}))})},handleCancel:function(){this.close()},onChangeCheck:function(e){e.indeterminate=!!e.selected.length&&e.selected.length<e.actionsOptions.length,e.checkedAll=e.selected.length===e.actionsOptions.length},onChangeCheckAll:function(e,t){Object.assign(t,{selected:e.target.checked?t.actionsOptions.map(function(e){return e.value}):[],indeterminate:!1,checkedAll:e.target.checked})},loadPermissions:function(){var e=this;Object(l["b"])().then(function(t){var n=t.result;e.permissions=n.map(function(e){var t=Object(c["a"])(e.actionData);return e.checkedAll=!1,e.selected=[],e.indeterminate=!1,e.actionsOptions=t.map(function(e){return{label:e.describe,value:e.action}}),e})})}}},f=m,p=n("2877"),h=Object(p["a"])(f,s,i,!1,null,"00d47234",null),b=h.exports,v={name:"TableList",components:{STable:o["a"],RoleModal:b},data:function(){var e=this;return{description:"列表使用场景：后台管理中的权限管理以及角色管理，可用于基于 RBAC 设计的角色权限控制，颗粒度细到每一个操作类型。",visible:!1,form:null,mdl:{},advanced:!1,queryParam:{},columns:[{title:"唯一识别码",dataIndex:"id"},{title:"角色名称",dataIndex:"name"},{title:"状态",dataIndex:"status"},{title:"创建时间",dataIndex:"createTime",sorter:!0},{title:"操作",width:"150px",dataIndex:"action",scopedSlots:{customRender:"action"}}],loadData:function(t){return e.$http.get("/role",{params:Object.assign(t,e.queryParam)}).then(function(e){return e.result})},selectedRowKeys:[],selectedRows:[]}},methods:{handleEdit:function(e){this.mdl=Object.assign({},e),this.mdl.permissions.forEach(function(e){e.actionsOptions=e.actionEntitySet.map(function(e){return{label:e.describe,value:e.action,defaultCheck:e.defaultCheck}})}),console.log(this.mdl),this.visible=!0},handleOk:function(){this.$refs.table.refresh()},onChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},toggleAdvanced:function(){this.advanced=!this.advanced}},watch:{}},g=v,w=Object(p["a"])(g,a,r,!1,null,null,null);t["default"]=w.exports},"88bc":function(e,t,n){(function(t){var n=1/0,a=9007199254740991,r="[object Arguments]",o="[object Function]",s="[object GeneratorFunction]",i="[object Symbol]",l="object"==typeof t&&t&&t.Object===Object&&t,c="object"==typeof self&&self&&self.Object===Object&&self,u=l||c||Function("return this")();function d(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function m(e,t){var n=-1,a=e?e.length:0,r=Array(a);while(++n<a)r[n]=t(e[n],n,e);return r}function f(e,t){var n=-1,a=t.length,r=e.length;while(++n<a)e[r+n]=t[n];return e}var p=Object.prototype,h=p.hasOwnProperty,b=p.toString,v=u.Symbol,g=p.propertyIsEnumerable,w=v?v.isConcatSpreadable:void 0,y=Math.max;function C(e,t,n,a,r){var o=-1,s=e.length;n||(n=_),r||(r=[]);while(++o<s){var i=e[o];t>0&&n(i)?t>1?C(i,t-1,n,a,r):f(r,i):a||(r[r.length]=i)}return r}function k(e,t){return e=Object(e),O(e,t,function(t,n){return n in e})}function O(e,t,n){var a=-1,r=t.length,o={};while(++a<r){var s=t[a],i=e[s];n(i,s)&&(o[s]=i)}return o}function j(e,t){return t=y(void 0===t?e.length-1:t,0),function(){var n=arguments,a=-1,r=y(n.length-t,0),o=Array(r);while(++a<r)o[a]=n[t+a];a=-1;var s=Array(t+1);while(++a<t)s[a]=n[a];return s[t]=o,d(e,this,s)}}function _(e){return S(e)||A(e)||!!(w&&e&&e[w])}function x(e){if("string"==typeof e||P(e))return e;var t=e+"";return"0"==t&&1/e==-n?"-0":t}function A(e){return F(e)&&h.call(e,"callee")&&(!g.call(e,"callee")||b.call(e)==r)}var S=Array.isArray;function E(e){return null!=e&&R(e.length)&&!$(e)}function F(e){return N(e)&&E(e)}function $(e){var t=I(e)?b.call(e):"";return t==o||t==s}function R(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=a}function I(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function N(e){return!!e&&"object"==typeof e}function P(e){return"symbol"==typeof e||N(e)&&b.call(e)==i}var L=j(function(e,t){return null==e?{}:k(e,m(C(t,1),x))});e.exports=L}).call(this,n("c8ba"))},bade:function(e,t,n){"use strict";function a(e){try{return JSON.parse(e)}catch(t){console.log("err",t.message)}return[]}n.d(t,"a",function(){return a})}}]);
//# sourceMappingURL=chunk-09ae8cc4.da6567fc.js.map